# Nixpacks configuration for Next.js SSR with Bun
# Security-hardened configuration

[phases.setup]
nixPkgs = ["bun"]
aptPkgs = ["build-essential"]
cmds = [
  "groupadd -r appgroup -g 1001 || true",
  "useradd -r -u 1001 -g appgroup -s /bin/sh -d /app appuser || true"
]

[phases.install]
cmds = ["bun install"]

[phases.build]
cmds = ["bun run build"]

[start]
cmd = "bun run start"
user = "appuser"

